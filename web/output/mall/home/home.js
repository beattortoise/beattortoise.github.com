$(function(){function a(a){for(var e=0,t=0,n=0,i=0,o=0,l=[],m=0;m<myData.length;m++){if("type"==a){switch(myData[m].type){case"bank":e++;break;case"insurance":t++}l=[{value:e,name:"银行理财"},{value:t,name:"保险"}]}"week"==a&&(myData[m].week>11?i++:myData[m].week>5?o++:myData[m].week>0&&n++,l=[{value:n,name:"短期"},{value:o,name:"中期"},{value:i,name:"长期"}]),"year"==a&&(myData[m].year>10?i++:myData[m].year>5?o++:myData[m].year>0&&n++,l=[{value:n,name:"<=5%"},{value:o,name:"5%<x<=10%"},{value:i,name:">10%"}])}return l}function e(){$(".circle").map(function(e,n){var i=$(this).attr("id");t.series[0].data=a(i),t.legend.data=a(i),echarts.init(document.getElementById(i)).setOption(t)}),$(".form_datetime").datetimepicker({format:"yyyy/mm/dd",minView:2,autoclose:!0,startDate:""}),calUtil.data=myData,calUtil.init()}myData=[{plat:"支付宝",mark:"财付通",money:1,year:1,week:1,day:"2017/01/01",cal:27397260273972603e-21,payment:1.000027397260274,payday:"2017/01/08",type:"bank"}];var t={color:["#fd6649","#54dc8a","#0ba57f","#5ca0ca","#4f5e73","#95a8ad","#b68f6b","#f8937f","#6e7074","#546570","#c4ccd3"],legend:{orient:"vertical",x:"right",top:"40",itemWidth:"15",formatter:"{name}",data:[]},series:[{name:"数据分析",type:"pie",radius:["50%","80%"],avoidLabelOverlap:!1,label:{normal:{show:!1,position:"center"},emphasis:{show:!0,formatter:"{b}\n({d}%)",textStyle:{fontSize:"22",fontWeight:"bold"}}},labelLine:{normal:{show:!1}},data:[]}]};e();new Date;normalData={plat:"",mark:"",money:"",year:"",week:"",day:"",cal:"",payment:"",payday:"",type:"bank"};var n=["plat","mark","money","year","week","day","cal","payment","payday","type"];new Vue({el:"#app",data:{myData:myData,normalData:normalData,old:""},mounted:function(){$(".form_datetime").datetimepicker({format:"yyyy/mm/dd",minView:2,autoclose:!0})},methods:{doDiv:function(a,e,t){$(".form_datetime").datetimepicker({format:"yyyy/mm/dd",minView:2,autoclose:!0,startDate:""});var n=$(e.target);n.hide(),n.siblings("input").show().focus(),this.old=n.html()},doInput:function(a,t,i){function o(){if(a.day&&a.week){for(var t=new Date(a.day).getTime()+604800*a.week*1e3,n=new Date(t).toLocaleString().split(" ")[0].split("/"),i=0;i<n.length;i++)1==n[i].length&&(n[i]="0"+n[i]);a.payday=n.join("/")}a.week&&a.year&&a.money&&(a.cal=parseFloat(a.money)*parseFloat(a.week)/365*parseFloat(a.year/100),a.payment=parseFloat(a.money)*parseFloat(a.week)/365*parseFloat(a.year/100)+parseFloat(a.money),e())}function l(){if(a.plat&&a.money&&a.year&&a.week&&a.day){myData.push(JSON.parse(JSON.stringify(a)));for(var t=0;t<n.length;t++)this.normalData[n[t]]="";setTimeout(function(){this.normalData.day=""},1),e()}}var m=$(t.target);m.hide(),m.siblings("div").show(),m.hasClass("form_datetime")?m.change(function(){a.day=$(this).val(),o(),"add"==i?l():this.old!=$.trim(m.val())&&e()}):(o(),"add"==i?l():this.old!=$.trim(m.val())&&e())},doDelete:function(a){confirm("确定要删除吗？")&&(myData.splice(a,1),e())}}});$(".intro_now").on("click",function(){$(this);calUtil.showYear="",calUtil.showMonth="",calUtil.data=myData,calUtil.eventName="load",calUtil.init()}),$("#app").on("click",".payCheck",function(){var a=$(this),e=a.siblings("span").text(),t=e.substr(0,4),n=e.substr(5,2);0==n.substr(0,1)&&(n=n.substr(1,1)),calUtil.showYear=t,calUtil.showMonth=n,calUtil.data=myData,calUtil.eventName="load",calUtil.init()})});